# Loppukoe

## Sisällysluettelo

* TOC 
{:toc}

## Valmistautuminen 

Opettajan ohjeet: 

  - _Sinulla on häiriötön työskentelymahdollisuus tuntien ajan (yksilötyö)
  - _Sinulla on virtuaalikone, jolla voit hyökätä. Esim. Kali, voit toki käyttää mitä konetta haluat
    - _Tarpeeksi RAM-muistia
    - _Levyllä on vapaata tilaa
  - _Maalikuvat voivat sisältää esimerkiksi binäärejä, Docker-kuvia tai virtuaalikoneita.
    - _Docker-kuvia olisi hyvä saada käyntiin omassa virtuaalikoneessa (esim Kalissa)
    - _Sinulla tulisi olla kone, jossa uskallat ajaa binäärejä (sekä maalibinäärejä että harjoituksen arviointiin liittyviä).
  - _Tiedät, miten saa uuden (VirtualBox) virtuaalikoneen samaan verkkoon hyökkäyskoneen kanssa
  - _Runsain mitoin hakkeriasennetta

Ensimmäisen ja viimeisen kohdalta homma on hallussa, ja virtuaalikoneen saaminen samaan verkkoon myös onnistuu, meillä on aiemmissa harjoituksissa käytettyä Host-only Adapter #3 jolla on DHCP palvelin. 

### Hyökkääjä Kali

Poistetaan muut VirtualBoxin virtuaalikoneet paitsi toinen harjoituksissa käytetty hyökkääjä Kali Goat. Lisätään sille vähän muistia 2048 --> 4096 MB. Sillä on 80 GB dynaamisesti allokoitua tallennustilaa josta 16.23 käytetty.

#### Palomuuri

Katsotaan että ufw on toiminnassa ja päästää kaiken ulosmenevän läpi ja kieltää kaiken sisääntulevan lähtökohtaisesti. Yritetään muistaa harjoituksia tehdessä tämä myös ja muuttaa asetuksia tarpeiden mukaan. 

#### Välityspalvelin

Katsotaan että OWASP ZAP ja FoxyProxy on asennettuna. ZAP on portissa 8090. Poistetaan FoxyProxyn patterneista nykyiset asetukset localhostia ja Host-only aliverkkoa lukuunottamatta.

#### Dockerin asennus

Seurataan ohjeet Dockerin asentamiseksi: [https://linuxhint.com/install_docker_kali_linux/](https://linuxhint.com/install_docker_kali_linux/)

```bash 
sudo apt update
└─$ curl -fsSL https://download.docker.com/linux/debian/gpg | sudo apt-key add - 
Warning: apt-key is deprecated. Manage keyring files in trusted.gpg.d instead (see apt-key(8)).
OK
```

Luetaan että apt-key on tosiaan vanhentunut. Etsitään tuoreemmat virallisemmat ohjeet: [https://www.kali.org/docs/containers/installing-docker-on-kali/](https://www.kali.org/docs/containers/installing-docker-on-kali/)

```bash
sudo apt install -y docker.io
```

Nyt pitäisi voida käyttää dockeria sudona. Parempi testata heti

```bash 
sudo apt update
# default metapackage mikä pitää olla asennettu (ei välttämättä jos ei asenneta Kalia dockeriin)
sudo apt -y install kali-linux-headless
# kokeillaan docker
sudo docker run hello-world
# Toimii: [https://hub.docker.com/_/hello-world](https://hub.docker.com/_/hello-world)
# kokeillaan ubuntu 
sudo docker run -it ubuntu bash
# ollaan nyt ubuntu root, katsotaan osoite
hostname -I 
172.17.0.2 
# pingataan sitä kalista, läpi menee 
└─$ ping 172.17.0.2 
PING 172.17.0.2 (172.17.0.2) 56(84) bytes of data.
64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.063 ms
...
# suljetaan docker container ja pingataan uudestaan, ei inahdustakaan. Näinhän sen kuuluukin toimia.
```

Poistetaan testinä toiminut Ubuntu container ja image: [https://www.freecodecamp.org/news/how-to-remove-images-in-docker/](https://www.freecodecamp.org/news/how-to-remove-images-in-docker/)

```bash
# ensin kontti
sudo docker ps -a
sudo docker rm pensive_franklin  
# sitten img
sudo docker images
sudo docker rmi ba6acccedd29
```

All done. Eiköhän olla valmiina kokeeseen, sormet ristiin ja toivotaan parasta. 



