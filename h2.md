[<-- Takaisin etusivulle](index.md)

# h2 turbo boosted 

## Lue ja tiivistä: € Jaswal 2020: Mastering Metasploit - 4ed: [Chapter 1: Approaching a Penetration Test Using Metasploit](https://www.oreilly.com/library/view/mastering-metasploit/9781838980078/B15076_01_Final_ASB_ePub.xhtml#_idParaDest-30) 
(kohdasta "Conducting a penetration test with Metasploit" luvun loppuun)

## [SQLZoo 0 - 2](https://sqlzoo.net/wiki/SELECT_basics) 
### kommentti edellisviikon SQL-tehtäviin 
WebGoatin injektioiden ja niiden perusteellisen käsittelyn tunnilla jälkeen SQLZoon alkupään harjoitukset vaikuttavat (aluksi! muuttuvat hankalimmiksi, edit.) helpoilta. 
Ymmärsin viime tunnin jälkeen myös edellisessä harjoituksessa kaihertamaan jääneen kommenttimerkinnän tärkeyden injektioissa. 
Jos syöttökenttä odottaa dataa merkkijonomuodossa ja on altis injektioille kannattaa omat queryt tehdä näin:
`'; OMA QUERY ; --` 
Eli päätetään merkkijono, päätetään kysely, syötetään oma kysely, päätetään oma kysely, kommentoidaan oman kyselyn jälkeen tulevat kyselyt pois.
Näin ei tarvitse välittää siitä mitä omaa queryä ennen tai sen jälkeen oli tapahtumassa.  
Tämä ei varmaan ole hopealuoti ja toimi joka tilanteessa mutta tästä voi lähteä liikkeelle. 
Numeerista dataa odottavaan kenttään kannattanee antaa jokin arvo yksittäisen heittomerkin sijasta eli
`0; OMA QUERY ; --` 

### 0: 1-3
Mutta, tämänviikkoisiin tehtäviin. 
  - Ensimmäisissä kahdessa tehtävässä kysely ja syötettävät stringit ovat annettu valmiina. 
  - Kolmannessa tehtävässä käytetään `WHERE area BETWEEN luku1 AND luku2` ja luvut annetaan valmiina.
Saman tehtävän voi ratkaista myös suurempi kuin tai yhtäsuuri ja pienempi kuin tai yhtäsuuri merkeillä. `WHERE area >= luku1 AND area <= luku2` 
SQL:ssä yhtäsuuruusmerkki tulee pienempi/suurempi kuin merkin jälkeen. 

### 1: 1-13
  - Tehtävässä 2 pääsee käyttämään viime tunnilla opittua jippoa, SQL:ssä nollien määrän voi ilmaista esim. miljoonassa näin
`1e6`. 
Käytetään sitä näyttämään kaikki 200 miljoonaa ylittävät maat:
`WHERE population >= 200e6`
  - Tehtävässä 3 siirrytään jo ihan oikeisiin kyselyihin. 
> Give the name and the per capita GDP for those countries with a population of at least 200 million. 
Joudun katsomaan vihjeestä että tässä ei haeta pelkkää GDP:tä vaan GDP:tä asukasta kohden. 
Aiemmasta SQL-kokemuksesta tiedän että sarakkeita voi nimetä itse ([SQL Aliases](https://www.w3schools.com/sql/sql_alias.asp)) komennolla `sarake AS [oma sarake]`. Se on käytännöllistä tällaisissa tapauksissa.
Tehdään kysely `SELECT name, (gdp/population) AS [Per capita GDP] FROM world WHERE population >= 200e6`
Tulee error ja virheilmoitus että MariaDB:ssä tämä ei toimi. Katsotaan [MariaDB aliases](https://www.techonthenet.com/mariadb/alias.php).
Luodaan uusi kysely heittomerkeillä(!) hakasulkujen sijaan. 
`SELECT name, (gdp/population) AS "Per capita GDP" FROM world WHERE population >= 200e6`
Läpi menee. Katsotaan vielä opetusvideo aiheesta. Sulkumerkit jakolaskun ympärillä olivat tarpeettomat.
  - Tehtävässä 4 tulee mielenkiintoinen ongelma. Vaikka aiemmin nollien merkintä miljoonassa `1e6` syntaksilla onnistui, jakolaskussa se ei toimikaan.
Ei toimi:
`SELECT name, population/1e6 FROM world WHERE continent = 'South America'`
Toimii:
`SELECT name, population/1000000 FROM world WHERE continent = 'South America'`
Nollilla tehtävä menee läpi. Huomaan että ensimmäinen kysely antaa enemmän desimaaleja joillakin riveillä. 
Muokataan kyselyä niin että vastaukset pyöristetään neljään desimaaliin:
`SELECT name, ROUND(population/1e6, 4) AS "Population in millions" FROM world WHERE continent = 'South America'`
Herjaa edelleen että väärä vastaus. Ajetaan sama kysely mutta `1e6` korvataan `1000000`:lla. Vastaus näyttää aivan samalta mutta menee tällä kertaa läpi. 
[Verrataan vastauksia](https://text-compare.com/), vasemmalla hyväksytty ja oikealla hylätty vastaus: 
Vastaukset ovat identtiset. Kyseessä täytyy olla SQLzoon konfiguraatio eikä varsinainen virhe queryssä. 
  - Tehtävässä 5 joudun selaamaan basiceihin ja muistelemaan [IN operaattorin](https://www.w3schools.com/sql/sql_in.asp) käyttöä.
`WHERE name IN ('France', 'Germany', 'Italy')` eli `IN ()` kun halutaan hakea useampi osuma.
  - Tehtävässä 6 käytetään jokeria `%jotain%` ja [LIKE operaattoria](https://www.w3schools.com/sql/sql_like.asp). 
`WHERE name LIKE '%United%'`
  - Tehtävässä 7 käytetään OR-operaattoria.
`WHERE area >= 3e6 OR population >= 250e6` 
  - Tehtävä 8 on sama mutta XOR-operaattorilla (joko tai). Eli jos molemmat ehdot täyttyvät tulosta ei kelpuuteta palautettavaan vastaukseen.
`SELECT name, population, area FROM world WHERE area > 3e6 XOR population > 250e6`
  - Tehtävässä 9 käytetään ROUND-operaattoria jota ennätinkin jo käyttää aiemmin. Tehdään tehtävä ensin oikean vastauksen varmistamiseksi jälleen nollilla ja kokeillaan sen jälkeen e-annotaatiota.
`SELECT name, ROUND(population/1000000, 2) AS "Population in millions", ROUND(gdp/1000000000, 2) AS "GDP in billions" FROM world WHERE continent = 'South America'`  
Kokeillaan helpompaa merkintätapaa:
`SELECT name, ROUND(population/1e6, 2) AS "Population in millions", ROUND(gdp/1e9, 2) AS "GDP in billions" FROM world WHERE continent = 'South America'` 
Herjaa väärää vastausta. Vastaus on kuitenkin jälleen täsmälleen sama. 
  - Tehtävässä 10 trillion dollar economies e-annotaatio toimii jälleen onneksi. Pyöristys tuhansiin tapahtuu -3 eli miinus kolme nollaa. 
`SELECT name, ROUND(gdp/population, -3) AS "Per capita GDP" FROM world WHERE gdp >= 1e12;`
  - Tehtävässä 11 vertaillaan merkkijonojen pituuksia [LENGTH-operaattorilla](https://sqlzoo.net/wiki/LENGTH).
`SELECT name, capital FROM world WHERE LENGTH(name) = LENGTH(capital);`  
  - Tehtävässä 12 käytetään LEFT- ja NOT EQUALS-operaattoreita. `LEFT()` laskee montako merkkiä merkkijonosta otetaan vasemmalta laskien.
`SELECT name, capital FROM world WHERE LEFT(name,1) = LEFT(capital,1) AND name <> capital;`


[<-- Takaisin etusivulle](index.md)
