# Tunkeutumistestaus-kurssi

## h1: Vuohi, tappoketju ja pimeän verkon päiväkirjat 
Tehtävät: [Kurssisivu ja tehtävät](https://terokarvinen.com/2021/penetration-testing-course-2021-autumn/#h1-vuohi-tappoketju-ja-pimean-verkon-paivakirjat)

### Lue ja tiivistä

#### OWASP 10 A03:2021 - Injection 
- Injektitiot ovat kuten otsikkokin kertoo kolmanneksi yleisin hyökkäysvektori vuonna 2021 
- Injektiot käsittelevät ohjelmistodataa tavoin joka ei ole tarkoitettu injektion syöttäjälle
- Injektiolle alttiit ohjelmat mm: 
  * eivät validoi, filtteröi tai sanitarisoi käyttäjäsyötteitä 
  * mahdollistavat väärän datan vastaanottamisen
- Suojatumista varten data on erotettava komennoista ja kyselyistä
- Oma idea: periaate on tuttu ja SQL-injektioita on tullut joskus kokeiltua WebGoatilla.

#### Intelligence-Driven Computer Network Defense Informed by Analysis of Adversary Campaigns and Intrusion Kill Chains
- Lockheed Martin esittelee Intelligence-Driven Computer Network Defensen teorian ja empirian avulla artikkelissa. 
- Varautumista tiedustelua tai erittäin määrätietoista hyökkääjää vastaan joka on valmis käyttämään aikaa ja resursseja hyökkäyksensä toteuttamiseen, koskee yleensä valtioita tai erittäin arvokkaita yrityksiä.
- Cyber Kill Chain on yhtä vahva kuin heikoin lenkkinsä ja sen voi katkaista missä tahansa ketjun vaiheessa hyökkääjän torjumiseksi. 
- Hyökkäyksen vaiheet: Reconnaissance, Weaponization, Delivery, Exploitation, Installation, C2 (Command and Control) ja Actions on Objectives (tässä vaiheessa hyökkääjä saavuttaa tavoitteensa)
- Oma idea: vaikuttaa että kyseessä on paremminkin tiedustelupalveluiden ja todella korkean tason toimijoiden varautumisesta ja ongelmista, mutta tappoketjua ja analyysia voi kyllä soveltaa matalammankin tason ja omassa toiminnassa. 

#### Darknet Diaries podcast 
- Jakso 69: Human Hacker 
- Käsittelee huijareita ja social engineeringiä ja phishingiä. 
- Vieraana Christopher Hadnagy joka kertoo jännittäviä tarinoita siitä kuinka he ovat murtautuneet erilaisiin järjestelmiin kollegansa kanssa, jamaikalainen pankki jota vartioivat haulikoilla varustautuneet skootterikuskit päätarinana. 
- Lisäksi kuinka hän on perustanut yrityksiä ja kirjoittanut kirjoja ja mistä hän on löytänyt oppinsa.
- Oma idea: Valitsin jakson koska social engineeringiä ei käsitellä paljoa kurssilla mutta se on kuitenkin monesti osa hyökkäystä. 

### Kali Linux
Asennetaan Kali Linux VirtualBoxiin. Ladataan VM-tiedosto Kalin sivuilta jota opettaja suosittelee. Katsotaan asennusvideo. Luetaan asennusohjeita. Oikeastaan mitään näistä ei tarvittu koska kaikki oli valmiiksi asennettu oikein asennustiedostossa, joka vain importataan VirtualBoxiin. Elämäni aikana mikään ei ole ollut näin helppoa tietokoneella. Jopa käyttäjänimi ja salasana on annettu VB:n Descriptionissa. Kokeillaan ensimmäiseksi verkkoyhteyttä virtuaalikoneessa, mennään sen selaimella osoitteeseen www.google.com. Kaikki toimii out-of-the-box, uskomatonta. Myös aiemmin ongelmia aiheuttaneet VB Guest Additions toimii ilman erillisiä toimenpiteitä. 

![Kali](/Kali internet toimii.PNG)

### Over The Wire 
En ollut varma oliko ensimmäisessä tehtävässä tarkoitus (onko turvallista) ottaa suoraan omalta koneelta yhteyttä Over The Wire:n [Over The Wire](https://overthewire.org/wargames/bandit/) palvelimeen ja jahkailin tehtävän aloittamisen kanssa. Hyvä niin, otetaan yhteyttä nyt asennetulla Kalilla. 

Vaihdetaan ensin Kalin näppäimistö English → Finnish. 

Otetaan ssh-yhteys Over The Wireen. 
`ssh bandit0@bandit.labs.overthewire.org -p 2220`

Tarjoaa fingerprinttiä: ECDSA key fingerprint is SHA256:98UL0ZWr85496EtCRkKlo20X3OPnyPSB5tB5RPbhczc.
Lienee pakko hyväksyä vaikka ei ole mitään mihin verrata sormenjälkeä, eikö ohjeissa olisi voitu antaa se?

![Fingerprint](/overthewire sormenjälki.PNG)

Saadaan yhteys, luetaan ohjeita. Kirjoitusoikeudet kotikansioon on kielletty, luodaan tarvittaessa wd /tmp/ kansioon komennolla
`mktemp -d` 
Lukuoikeudet /tmp/ ja /proc/ kansioihin on kielletty. ASLR (Address-space Layout Randomization [ASLR](https://fi.wikipedia.org/wiki/ASLR) on kytketty pois päältä palvelimella. 

Ohjeissa annetaan lisäksi seuraavat työkalut tiedostopolkuineen:  
For your convenience we have installed a few usefull tools which you can find in the following locations:
- gef (https://github.com/hugsy/gef) in /usr/local/gef/
- pwndbg (https://github.com/pwndbg/pwndbg) in /usr/local/pwndbg/
- peda (https://github.com/longld/peda.git) in /usr/local/peda/
- gdbinit (https://github.com/gdbinit/Gdbinit) in /usr/local/gdbinit/
- pwntools (https://github.com/Gallopsled/pwntools)
- radare2 (http://www.radare.org/)
- checksec.sh (http://www.trapkit.de/tools/checksec.html) in /usr/local/bin/checksec.sh

Jatketaan harjoitusta. Readme-tiedostosta löytyy seuraava salasana. Vaihdetaan käyttäjä bandit0:sta bandit1:seen ja jatketaan näin harjoituksia aina viimeiseen harjoitukseen saaakka. Viimeisessä tasossa on kymmenen tiedostoa ja tuntuu turvallisimmalta avata ne editorilla, käytän nanoa. Käyn tiedostot yksitellen läpi manuaalisesti (ei varmaan paras idea?) ja löydän lopulta tiedostosta -file07 viimeisen salasanan. 

![Bandit](/overthewire tiedostot vikassa tehtävässä.PNG)
![Bandit](/overthewire vika salasana.PNG)

Käytetään tuota seuraavissa tehtävissä sitten: [Bandit6](https://overthewire.org/wargames/bandit/bandit6.html) 
Seuraavaa tehtävää varten myös pitää tutustua find-komentoon ja ihmisluettaviin tiedostoihin paremmin: [Human-readable files](https://unix.stackexchange.com/questions/313442/find-human-readable-files/353879)



**Bold** and _Italic_ and `Code` text

[Link](url) and ![Image](src)

